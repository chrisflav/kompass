{% extends "admin/change_form_object_tools.html" %}
{% load i18n admin_urls rules %}

{% block object-tools-items %}

{% if original.confirmed and perms.finance.may_manage_confirmed_statements %}
<li>
    {% url opts|admin_urlname:'unconfirm' original.pk|admin_urlquote as invite_url %}
    <a class="historylink" href="{% add_preserved_filters invite_url %}">{% trans 'Unconfirm' %}</a>
</li>
<li>
    {% url opts|admin_urlname:'summary' original.pk|admin_urlquote as invite_url %}
    <a class="historylink" target="_blank" href="{% add_preserved_filters invite_url %}">{% trans 'Download summary' %}</a>
</li>
{% elif original.submitted and perms.finance.process_statementsubmitted %}
<script>
function requestWithCurrentURL(path) {
    var xpath = path + "?redirectTo=" + window.location.href;
    location.href = xpath;
}
</script>

<li>
    {% url opts|admin_urlname:'reduce_transactions' original.pk|admin_urlquote as invite_url %}
    <a value="hi" onclick='requestWithCurrentURL("{% add_preserved_filters invite_url %}")'>
    {% trans 'Reduce transactions' %}
    </a>
</li>
<li>
    {% url opts|admin_urlname:'overview' original.pk|admin_urlquote as invite_url %}
    <a class="historylink" href="{% add_preserved_filters invite_url %}">{% trans 'Overview' %}</a>
</li>
{% elif not original.submitted %}
<li>
    {% url opts|admin_urlname:'submit' original.pk|admin_urlquote as invite_url %}
    <a class="historylink" href="{% add_preserved_filters invite_url %}">{% trans 'Submit' %}</a>
</li>
{% endif %}
{{block.super}}

{% endblock %}
